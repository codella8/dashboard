{% extends 'container/container_base.html' %}
{% load static %}

{% block content %}
<div class="financial-report">
    <div class="container">
        <div class="content-wrapper">
            <!-- Header Section -->
            <div class="page-header">
                <div class="title-section">
                    <h4>Ú¯Ø²Ø§Ø±Ø´ Ù…Ø§Ù„ÛŒ Ú©Ø§Ù†ØªÛŒÙ†Ø± â€” {{ container.container_number }}</h4>
                    <p class="text-muted">{{ container.name }}</p>
                </div>
                <div class="text-right">
                    <a class="btn-back" href="{% url 'containers:list' %}">
                        â† Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù„ÛŒØ³Øª Ú©Ø§Ù†ØªÛŒÙ†Ø±Ù‡Ø§
                    </a>
                </div>
            </div>

            <!-- Stats Grid -->
            <div class="row stats-grid">
                <div class="col-md-4">
                    <div class="stat-card income-card">
                        <h6>Ú©Ù„ Ø¯Ø±Ø¢Ù…Ø¯</h6>
                        <div class="display-4">{{ financial_summary.total_income|default:0|floatformat:0 }}</div>
                        <small>Ø§Ø² ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§ÛŒ ÙØ±ÙˆØ´</small>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="stat-card sales-card">
                        <h6>Ú©Ù„ ØªØ¹Ø¯Ø§Ø¯ ÙØ±ÙˆØ®ØªÙ‡â€ŒØ´Ø¯Ù‡</h6>
                        <div class="display-4">{{ financial_summary.total_sold_qty|default:0|floatformat:0 }}</div>
                        <small>Ø¨Ù‡ ØªÙÚ©ÛŒÚ© ÙˆØ§Ø­Ø¯</small>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="stat-card inventory-card">
                        <h6>ØªØ¹Ø¯Ø§Ø¯ Ù…Ø­ØµÙˆÙ„Ø§Øª</h6>
                        <div class="display-4">{{ container.Inventory_container.count|default:0 }}</div>
                        <small>Ù…Ø­ØµÙˆÙ„Ø§Øª Ø¯Ø± Ú©Ø§Ù†ØªÛŒÙ†Ø±</small>
                    </div>
                </div>
            </div>

            <!-- Transactions Section -->
            <div class="transactions-section">
                <h5 class="section-title">ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§</h5>
                
                <div class="transactions-table">
                    <table class="table">
                        <thead class="table-header">
                            <tr>
                                <th>ØªØ§Ø±ÛŒØ®</th>
                                <th>Ù…Ø­ØµÙˆÙ„</th>
                                <th>ØªØ¹Ø¯Ø§Ø¯</th>
                                <th>Ù‚ÛŒÙ…Øª Ú©Ù„</th>
                                <th>ÙˆØ¶Ø¹ÛŒØª ÙØ±ÙˆØ´</th>
                                <th>ÙˆØ¶Ø¹ÛŒØª Ù¾Ø±Ø¯Ø§Ø®Øª</th>
                            </tr>
                        </thead>
                        <tbody class="table-body">
                            {% for tx in transactions %}
                            <tr>
                                <td>{{ tx.created_at|date:"Y-m-d H:i" }}</td>
                                <td>{{ tx.product|default:"-" }}</td>
                                <td>
                                    <span class="quantity-normal">{{ tx.quantity|default:0 }}</span>
                                </td>
                                <td>
                                    <span class="price-positive">{{ tx.total_price|floatformat:0 }}</span>
                                </td>
                                <td>
                                    <span class="status-badge 
                                        {% if 'sold' in tx.sale_status %}status-sold
                                        {% elif 'pending' in tx.sale_status %}status-pending
                                        {% else %}status-cancelled{% endif %}">
                                        {{ tx.get_sale_status_display }}
                                    </span>
                                </td>
                                <td>
                                    <span class="status-badge 
                                        {% if 'paid' in tx.payment_status %}status-paid
                                        {% elif 'partial' in tx.payment_status %}status-partial
                                        {% else %}status-unpaid{% endif %}">
                                        {{ tx.get_payment_status_display }}
                                    </span>
                                </td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="6">
                                    <div class="empty-state">
                                        <i>ğŸ“Š</i>
                                        <p>ØªØ±Ø§Ú©Ù†Ø´ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª</p>
                                    </div>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}