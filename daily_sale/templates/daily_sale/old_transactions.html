{% extends "daily_sale/daily_sale_base.html" %}
{% block title %}Old Transactions{% endblock %}

{% block content %}
<h3>Old Transactions</h3>

{% if outstanding_list %}
  <div class="table-responsive">
    <table class="table table-striped">
      <thead><tr><th>Customer</th><th>Phone / Email</th><th>Transactions</th><th>Last</th><th>Total Debt</th><th>Actions</th></tr></thead>
      <tbody>
        {% for o in outstanding_list %}
          <tr>
            <td>{{ o.customer.user.get_full_name|default:o.customer }}</td>
            <td>{{ o.customer.phone }}<br><small>{{ o.customer.user.email }}</small></td>
            <td>{{ o.transactions_count }}</td>
            <td>{{ o.last_transaction }}</td>
            <td>{{ o.total_debt }}</td>
            <td>
              <form method="post" action="{% url 'daily_sale:mark_old_transactions_paid' o.customer.id %}" style="display:inline;">
                {% csrf_token %}
                <button type="submit" class="btn btn-sm btn-success" onclick="return confirm('Mark all outstanding transactions for this customer as paid?');">Mark Paid</button>
              </form>
              <a class="btn btn-sm btn-secondary" href="{% url 'admin:daily_sale_oldtransaction_change' o.id %}">Admin</a>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
{% else %}
  <div class="alert alert-info">No outstanding customers.</div>
{% endif %}
{% endblock %}
