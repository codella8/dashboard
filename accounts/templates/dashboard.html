{% extends "accounts_base.html" %}
{% load static %}

{% block title %}Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ù…Ø±Ú©Ø²ÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
{% endblock %}

{% block content %}
<div class="dashboard-container">
    <!-- Ù‡Ø¯Ø± Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ -->
    <div class="dashboard-header-professional py-4 mb-5">
        <div class="container-fluid">
            <div class="row align-items-center">
                <div class="col-lg-8">
                    <div class="fade-in-up">
                        <h1 class="display-4 fw-bold text-dark mb-2">
                            ğŸš€ Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ù…Ø±Ú©Ø²ÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯
                        </h1>
                        <p class="lead text-muted mb-0">
                            Ù…Ø¯ÛŒØ±ÛŒØª ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡ Ùˆ Ù„Ø­Ø¸Ù‡â€ŒØ§ÛŒ ØªÙ…Ø§Ù… Ø¨Ø®Ø´â€ŒÙ‡Ø§ÛŒ Ø´Ø±Ú©Øª
                        </p>
                    </div>
                </div>
                <div class="col-lg-4 text-lg-end">
                    <div class="fade-in-up">
                        <div class="user-badge-pro d-inline-flex align-items-center">
                            <i class="fas fa-user-circle me-2"></i>
                            <span>Ú©Ø§Ø±Ø¨Ø±: {{ request.user.get_full_name|default:request.user.username }}</span>
                            <div class="ms-3 pulse-dot"></div>
                        </div>
                        <div class="mt-2">
                            <small class="text-muted">
                                <i class="fas fa-clock me-1"></i>
                                <span id="persian-date">--</span>
                            </small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container-fluid">
        <!-- Ø¢Ù…Ø§Ø± Ú©Ù„ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡ -->
        <div class="row mb-5">
            <div class="col-xl-3 col-md-6 mb-4">
                <div class="stat-card-pro success fade-in-up" style="animation-delay: 0.1s;">
                    <div class="card-body p-4">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h2 class="display-6 fw-bold mb-1">{{ quick_stats.total_sales }}</h2>
                                <p class="mb-0 opacity-90">ØªØ±Ø§Ú©Ù†Ø´ ÙØ±ÙˆØ´</p>
                                <small class="opacity-75">
                                    <i class="fas fa-arrow-up me-1"></i>
                                    Û±Û²Ùª Ø±Ø´Ø¯ Ù†Ø³Ø¨Øª Ø¨Ù‡ Ù…Ø§Ù‡ Ù‚Ø¨Ù„
                                </small>
                            </div>
                            <div class="stat-icon">
                                <i class="fas fa-shopping-cart fa-2x opacity-50"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xl-3 col-md-6 mb-4">
                <div class="stat-card-pro primary fade-in-up" style="animation-delay: 0.2s;">
                    <div class="card-body p-4">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h2 class="display-6 fw-bold mb-1">{{ quick_stats.total_inventory }}</h2>
                                <p class="mb-0 opacity-90">Ø¢ÛŒØªÙ… Ù…ÙˆØ¬ÙˆØ¯ÛŒ</p>
                                <small class="opacity-75">
                                    <i class="fas fa-boxes me-1"></i>
                                    Ø¯Ø± Û¸ Ø§Ù†Ø¨Ø§Ø± Ù…Ø®ØªÙ„Ù
                                </small>
                            </div>
                            <div class="stat-icon">
                                <i class="fas fa-warehouse fa-2x opacity-50"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xl-3 col-md-6 mb-4">
                <div class="stat-card-pro info fade-in-up" style="animation-delay: 0.3s;">
                    <div class="card-body p-4">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h2 class="display-6 fw-bold mb-1">{{ quick_stats.active_containers }}</h2>
                                <p class="mb-0 opacity-90">Ú©Ø§Ù†ØªÛŒÙ†Ø± ÙØ¹Ø§Ù„</p>
                                <small class="opacity-75">
                                    <i class="fas fa-ship me-1"></i>
                                    Ûµ Ú©Ø§Ù†ØªÛŒÙ†Ø± Ø¯Ø± Ø±Ø§Ù‡
                                </small>
                            </div>
                            <div class="stat-icon">
                                <i class="fas fa-shipping-fast fa-2x opacity-50"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xl-3 col-md-6 mb-4">
                <div class="stat-card-pro warning fade-in-up" style="animation-delay: 0.4s;">
                    <div class="card-body p-4">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h2 class="display-6 fw-bold mb-1">{{ quick_stats.pending_expenses }}</h2>
                                <p class="mb-0 opacity-90">Ù‡Ø²ÛŒÙ†Ù‡ Ù…Ø¹Ù„Ù‚</p>
                                <small class="opacity-75">
                                    <i class="fas fa-clock me-1"></i>
                                    Ù†ÛŒØ§Ø² Ø¨Ù‡ ØªØ§ÛŒÛŒØ¯ Ù…Ø¯ÛŒØ±ÛŒØª
                                </small>
                            </div>
                            <div class="stat-icon">
                                <i class="fas fa-file-invoice-dollar fa-2x opacity-50"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ø§Ù¾â€ŒÙ‡Ø§ÛŒ Ø³ÛŒØ³ØªÙ… -->
        <div class="row g-4">
            {% for app in apps %}
            <div class="col-xxl-2 col-xl-3 col-lg-4 col-md-6">
                <div class="app-card-pro {% if app.active %}active{% else %}inactive{% endif %} fade-in-up"
                     
                     {% if apps.active %}onclick="window.location.href='{% url app.url_name %}'"{% endif %}>
                    <div class="card-body text-center p-4 position-relative">
                        <!-- ÙˆØ¶Ø¹ÛŒØª -->
                        <span class="status-badge-pro {% if app.active %}bg-success{% else %}bg-secondary{% endif %} text-white">
                            {% if app.active %}ÙØ¹Ø§Ù„{% else %}Ø¨Ù‡ Ø²ÙˆØ¯ÛŒ{% endif %}
                        </span>

                        <!-- Ø¢ÛŒÚ©ÙˆÙ† -->
                        <div class="app-icon-pro">
                            {{ app.icon }}
                        </div>

                        <!-- Ø¹Ù†ÙˆØ§Ù† -->
                        <h5 class="card-title fw-bold mb-2 text-dark">{{ app.name }}</h5>

                        <!-- ØªÙˆØ¶ÛŒØ­Ø§Øª -->
                        <p class="card-text text-muted small mb-3">{{ app.description }}</p>

                        <!-- Ø¯Ú©Ù…Ù‡ Ø§Ù‚Ø¯Ø§Ù… -->
                        {% if app.active %}
                        <div class="app-action">
                            <button class="btn btn-primary btn-sm rounded-pill px-3">
                                <i class="fas fa-arrow-left me-1"></i>
                                ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ù…Ø§Ú˜ÙˆÙ„
                            </button>
                        </div>
                        {% else %}
                        <div class="app-action">
                            <button class="btn btn-outline-secondary btn-sm rounded-pill px-3" disabled>
                                <i class="fas fa-clock me-1"></i>
                                Ø¨Ù‡ Ø²ÙˆØ¯ÛŒ
                            </button>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>

        <!-- Footer -->
        <div class="row mt-5">
            <div class="col-12 text-center">
                <div class="glass-card p-3">
                    <small class="text-white opacity-75">
                        <i class="fas fa-sync-alt me-1"></i>
                        Ø¢Ø®Ø±ÛŒÙ† Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ: 
                        <span id="live-update-time">Ù‡Ù… Ø§Ú©Ù†ÙˆÙ†</span>
                    </small>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// ØªØ§Ø±ÛŒØ® Ø´Ù…Ø³ÛŒ
function updatePersianDate() {
    const now = new Date();
    const options = {
        year: 'numeric',
        month: 'long',
        day: 'numeric',
        weekday: 'long'
    };
    const persianDate = now.toLocaleDateString('fa-IR', options);
    document.getElementById('persian-date').textContent = persianDate;
}

// Ø²Ù…Ø§Ù† Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø²Ù†Ø¯Ù‡
function updateLiveTime() {
    const now = new Date();
    const timeString = now.toLocaleTimeString('fa-IR');
    document.getElementById('live-update-time').textContent = timeString;
}

// Ø§Ø¹Ù…Ø§Ù„ Ø§Ù†ÛŒÙ…ÛŒØ´Ù† hover Ø±ÙˆÛŒ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§
document.addEventListener('DOMContentLoaded', function() {
    // ØªØ§Ø±ÛŒØ® Ø´Ù…Ø³ÛŒ
    updatePersianDate();
    
    // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø²Ù…Ø§Ù† Ù‡Ø± Ø«Ø§Ù†ÛŒÙ‡
    setInterval(updateLiveTime, 1000);
    
    // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† effect Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§
    const appCards = document.querySelectorAll('.app-card-pro.active');
    appCards.forEach(card => {
        card.addEventListener('click', function() {
            this.style.transform = 'scale(0.95)';
            setTimeout(() => {
                this.style.transform = '';
            }, 150);
        });
    });
});

// Ù¾ÙˆÛŒØ§Ù†Ù…Ø§ÛŒÛŒ dots Ø¨Ø±Ø§ÛŒ ÙˆØ¶Ø¹ÛŒØª Ø¢Ù†Ù„Ø§ÛŒÙ†
const style = document.createElement('style');
style.textContent = `
    .pulse-dot {
        width: 8px;
        height: 8px;
        background: #2ecc71;
        border-radius: 50%;
        animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
        0% { transform: scale(1); opacity: 1; }
        50% { transform: scale(1.5); opacity: 0.7; }
        100% { transform: scale(1); opacity: 1; }
    }
`;
document.head.appendChild(style);
</script>
{% endblock %}