{% extends "accounts_base.html" %}
{% load static %}
{% load i18n %}

{% block title %}User Profile - {{ user.get_full_name|default:user.username }}{% endblock %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/user_profile.css' %}">

<div class="user-profile-container">
    <div class="container">
        <div class="row">
            <!-- User Information Card -->
            <div class="col-lg-4 col-md-5 mb-4">
                <div class="card profile-card">
                    <div class="card-body text-center">
                        <div class="profile-avatar mb-3">
                            <i class="bi bi-person-circle" style="font-size: 4rem; color: #6c757d;"></i>
                        </div>
                        <h4 class="card-title mb-2">{{ user.get_full_name|default:user.username }}</h4>
                        <p class="text-muted mb-3">{{ user.email }}</p>
                        <div class="user-badge mb-3">
                            <span class="badge">
                                {% if user.is_staff %}
                                Administrator
                                {% else %}
                                Regular User
                                {% endif %}
                            </span>
                        </div>

                        <!-- Additional Info -->
                        <div class="profile-additional-info">
                            <div class="d-flex justify-content-between text-muted small mb-2">
                                <span>Member Since</span>
                                <span>{{ user.date_joined|date:"M Y" }}</span>
                            </div>
                            <div class="d-flex justify-content-between text-muted small">
                                <span>Last Login</span>
                                <span>{{ user.last_login|date:"M d, Y"|default:"Never" }}</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="card quick-actions-card mt-4">
                    <div class="card-header">
                        <h6 class="mb-0">Quick Actions</h6>
                    </div>
                    <div class="card-body">
                        <div class="d-grid gap-2">
                            <a href="{% url 'accounts:update_user' %}" class="btn btn-outline-primary">
                                <i class="bi bi-person-gear me-2"></i>
                                Edit Profile
                            </a>
                            <a href="{% url 'accounts:update_info' %}" class="btn btn-outline-secondary">
                                <i class="bi bi-info-circle me-2"></i>
                                Additional Info
                            </a>
                            <a href="{% url 'accounts:update_password' %}" class="btn btn-outline-warning">
                                <i class="bi bi-shield-lock me-2"></i>
                                Change Password
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Content -->
            <div class="col-lg-8 col-md-7">
                <!-- Activity Stats -->
                <div class="card profile-card">
                    <div class="card-header">
                        <h5 class="mb-0">Activity Summary</h5>
                    </div>
                    <div class="card-body">
                        <div class="row text-center">
                            <div class="col-md-3 col-6 mb-3">
                                <div class="stat-item">
                                    <h3 class="text-primary">0</h3>
                                    <small class="text-muted">Transactions</small>
                                </div>
                            </div>
                            <div class="col-md-3 col-6 mb-3">
                                <div class="stat-item">
                                    <h3 class="text-success">0</h3>
                                    <small class="text-muted">Projects</small>
                                </div>
                            </div>
                            <div class="col-md-3 col-6 mb-3">
                                <div class="stat-item">
                                    <h3 class="text-info">0</h3>
                                    <small class="text-muted">Reports</small>
                                </div>
                            </div>
                            <div class="col-md-3 col-6 mb-3">
                                <div class="stat-item">
                                    <h3 class="text-warning">0</h3>
                                    <small class="text-muted">Messages</small>
                                </div>
                            </div>
                        </div>

                        <!-- Progress Bar -->
                        <div class="mt-3">
                            <div class="d-flex justify-content-between small text-muted mb-1">
                                <span>Profile Completion</span>
                                <span>60%</span>
                            </div>
                            <div class="profile-progress">
                                <div class="profile-progress-bar" style="width: 60%"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- User Information -->
                <div class="card user-info-card">
                    <div class="card-header">
                        <h5 class="mb-0">User Information</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <p>
                                    <strong>Username:</strong>
                                    <span>{{ user.username }}</span>
                                </p>
                                <p>
                                    <strong>Email:</strong>
                                    <span>{{ user.email }}</span>
                                </p>
                                <p>
                                    <strong>First Name:</strong>
                                    <span>{{ user.first_name|default:"Not set" }}</span>
                                </p>
                            </div>
                            <div class="col-md-6">
                                <p>
                                    <strong>Last Name:</strong>
                                    <span>{{ user.last_name|default:"Not set" }}</span>
                                </p>
                                <p>
                                    <strong>Join Date:</strong>
                                    <span>{{ user.date_joined|date:"M d, Y" }}</span>
                                </p>
                                <p>
                                    <strong>Last Login:</strong>
                                    <span>{{ user.last_login|date:"M d, Y - H:i"|default:"Never" }}</span>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- User Guide -->
                <div class="card guide-card">
                    <div class="card-header">
                        <h5 class="mb-0">User Guide</h5>
                    </div>
                    <div class="card-body">
                        <div class="alert alert-info">
                            <h6><i class="bi bi-info-circle me-2"></i>Important Notes:</h6>
                            <ul class="mb-0">
                                <li>Contact system administrator for access to management sections</li>
                                <li>Keep your profile information up to date</li>
                                <li>Use "Change Password" option if you forget your password</li>
                                <li>Complete your additional information for better service</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Add hover effects to cards
        const cards = document.querySelectorAll('.profile-card, .quick-actions-card, .user-info-card, .guide-card');

        cards.forEach(card => {
            card.addEventListener('mouseenter', function () {
                this.style.transform = 'translateY(-5px)';
            });

            card.addEventListener('mouseleave', function () {
                this.style.transform = 'translateY(0)';
            });
        });

        // Animate stats counter (example)
        const statItems = document.querySelectorAll('.stat-item h3');

        statItems.forEach(stat => {
            const target = parseInt(stat.textContent);
            let current = 0;
            const increment = target / 50;

            const timer = setInterval(() => {
                current += increment;
                if (current >= target) {
                    stat.textContent = target;
                    clearInterval(timer);
                } else {
                    stat.textContent = Math.floor(current);
                }
            }, 30);
        });
    });
</script>
{% endblock %}